# 甜品店管理系统 - 前端使用指南

## 快速开始

### 1. 安装依赖
```bash
cd frontend
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```
前端将运行在 http://localhost:5173

### 3. 确保后端运行
后端需要运行在 http://localhost:8000，前端会自动代理所有 `/api` 请求到后端。

## 完整启动流程

### 方式一：使用启动脚本（推荐）
```bash
# 在项目根目录
./start.sh

# 停止服务
./stop.sh
```

### 方式二：手动启动
```bash
# 终端 1 - 启动后端
source venv/bin/activate
uvicorn main:app --reload

# 终端 2 - 启动前端
cd frontend
npm run dev
```

## 三大功能页面

### 📋 1. 基础设置 (Admin Setup)
**路径**: `/admin-setup`

#### 功能：
- **单位管理**: 创建计量单位（克、千克、个、毫升等）
- **分类管理**: 创建原料和半成品分类
- **批量创建原料**: 快速导入多个原料
- **批量创建半成品**: 快速导入多个半成品

#### 批量创建格式：
```
# 原料格式：名称,分类,单位,品牌(可选),阈值(可选)
草莓,水果,克,新鲜果园,50
蓝莓,水果,克,进口品牌,30
黄油,乳制品,克,安佳,100

# 半成品格式：名称,分类,单位,阈值(可选)
草莓酱,酱料,克,200
蓝莓酱,酱料,克,150
```

#### 操作流程：
1. 先创建单位（如：克、个、毫升）
2. 再创建分类（如：水果、乳制品）
3. 最后批量创建原料或半成品

---

### 📦 2. 采购管理 (Purchase Order)
**路径**: `/purchase-order`

#### 功能：
- 创建采购单
- 查看所有采购单列表
- 查看采购单详情
- 每个采购项可以指定不同供应商

#### 操作流程：
1. 点击"新建采购单"
2. 选择原料、单位
3. 输入数量、单价
4. 可选填写供应商
5. 点击"添加采购项"添加更多项目
6. 系统自动计算小计和总金额
7. 提交采购单

#### 界面特点：
- 实时计算每项小计
- 自动汇总总金额
- 卡片式展示采购单列表
- 弹窗查看详细信息

---

### 📊 3. 库存管理 (Inventory)
**路径**: `/inventory`

#### 核心功能：

##### 🔍 筛选和分组
- **按位置分组**: 方便仓库盘点（如：冷藏区A、冷藏区B）
- **按补货状态分组**: 快速找到需要补货的项目

##### 📈 排序功能
- **按实际库存排序**: 找出库存最低的项目
- **按标准库存排序**: 了解库存配置
- **按更新时间排序**: 查看最近更新的记录

##### ✏️ 库存更新
- 点击"编辑"按钮直接修改实际库存
- 系统自动根据原料阈值判断是否需要补货
- 实时保存和更新

##### ⚠️ 库存预警
- **需要补货**: 实际库存 < 原料阈值
- **充足**: 实际库存 ≥ 标准库存
- **正常**: 其他情况

#### 操作流程：

**创建库存记录**:
1. 点击"新建库存"
2. 选择原料和单位
3. 设置标准库存（目标值）
4. 输入实际库存（当前值）
5. 可选填写存放位置
6. 提交创建

**更新库存**:
1. 找到需要更新的库存项
2. 点击"编辑"
3. 修改实际库存数量
4. 点击"保存"
5. 系统自动重新计算补货状态

**查看库存**:
- 不分组: 表格视图，适合详细浏览
- 按位置分组: 卡片视图，方便仓库管理
- 按补货状态分组: 卡片视图，优先处理需要补货的项目

---

## 界面说明

### 导航栏
顶部紫色渐变导航栏，包含三个主页面链接：
- 基础设置
- 采购管理
- 库存管理

### 视图模式

#### 表格视图（不分组时）
- 紧凑展示所有信息
- 适合快速浏览大量数据
- 行内编辑功能

#### 卡片视图（分组时）
- 每个分组独立展示
- 更直观的视觉效果
- 适合分类管理

---

## 常见使用场景

### 场景 1: 新店初始化
1. 创建所有需要的单位（克、千克、个等）
2. 创建分类（水果、乳制品、酱料等）
3. 批量创建所有原料
4. 为每个原料创建库存记录

### 场景 2: 日常采购
1. 查看库存，识别需要补货的项目
2. 创建采购单，填写采购信息
3. 收货后更新库存实际数量

### 场景 3: 仓库盘点
1. 选择"按位置分组"
2. 逐个位置核对实际库存
3. 更新库存数量
4. 查看需要补货的项目

### 场景 4: 库存预警
1. 选择"按补货状态分组"
2. 查看"需要补货"组
3. 创建采购单补充库存
4. 收货后更新库存

---

## API 接口说明

所有 API 请求会自动添加以下配置：
- Base URL: `/api` (开发环境代理到 http://localhost:8000)
- Authorization: 自动添加 token (如果存在)
- Content-Type: `application/json`

### 主要 API 端点

**基础设置**:
- `GET /api/admin-setup/units` - 获取单位列表
- `POST /api/admin-setup/units` - 创建单位
- `GET /api/admin-setup/categories` - 获取分类列表
- `POST /api/admin-setup/categories` - 创建分类
- `POST /api/ingredients/batch` - 批量创建原料
- `POST /api/products/batch` - 批量创建半成品

**采购管理**:
- `GET /api/purchase-orders` - 获取采购单列表
- `POST /api/purchase-orders` - 创建采购单
- `GET /api/purchase-orders/{id}` - 获取采购单详情

**库存管理**:
- `GET /api/inventory?group_by=location&sort_by=actual_qty` - 获取库存
- `POST /api/inventory` - 创建库存记录
- `PUT /api/inventory/{id}` - 更新库存数量

---

## 开发说明

### 技术栈
- React 18
- React Router 6
- Axios
- Vite

### 目录结构
```
frontend/src/
├── pages/          # 页面组件
│   ├── AdminSetup.jsx
│   ├── PurchaseOrder.jsx
│   └── Inventory.jsx
├── services/       # API 服务
│   └── api.js
├── App.jsx         # 主应用（路由）
└── main.jsx        # 入口
```

### 样式约定
- 每个页面有独立的 CSS 文件
- 使用 BEM 命名规范
- 响应式设计支持移动端

### 状态管理
- 使用 React Hooks (useState, useEffect)
- 无需额外状态管理库
- API 调用封装在 services 层

---

## 常见问题

**Q: 前端无法连接后端？**
A: 确保后端运行在 http://localhost:8000，检查 vite.config.js 代理配置

**Q: 批量创建失败？**
A: 检查格式是否正确，确保单位和分类已存在

**Q: 库存更新后没有重新计算补货状态？**
A: 补货状态由后端自动计算，确保原料设置了阈值

**Q: 采购单无法创建？**
A: 确保选择了原料、单位，并填写了数量和单价

**Q: 页面加载慢？**
A: 检查网络连接，查看浏览器控制台是否有错误

---

## 后续优化方向

- [ ] 添加用户认证和权限管理
- [ ] 数据导出功能（Excel）
- [ ] 库存变动历史记录
- [ ] 采购单审批流程
- [ ] 数据可视化图表
- [ ] 移动端优化
- [ ] 打印功能
- [ ] 批量操作优化

---

## 联系支持

如有问题，请查看：
- 后端 API 文档: http://localhost:8000/docs
- 前端 README: `/frontend/README.md`
- 项目主 README: `/README.md`
